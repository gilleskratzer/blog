<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.40.1" />
  <meta name="author" content="Gilles Kratzer">

  
  
  
  
    
      
    
  
  <meta name="description" content="This post is highly inspired by this post and this post. Here is the necessary code to produce those graphs (be aware that it is time and memory consuming!).
On June 10 2013, RStudio provides CRAN mirror logs download from 2012-10-01. Then it is possible to analyze this rich and huge amount of data. On an individual level, one can track the popularity of their (preferred package). Here one can track the number of download of the three most downloaded R packages.">

  
  <link rel="alternate" hreflang="en-us" href="/post/download/">

  


  

  
  
  <meta name="theme-color" content="#0095eb">
  
  
  
  
    
  
  
    
    
      
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
      
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.1/css/academicons.min.css" integrity="sha512-NThgw3XKQ1absAahW6to7Ey42uycrVvfNfyjqcFNgCmOCQ5AR4AO0SiXrN+8ZtYeappp56lk1WtvjVmEa+VR6A==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">
  
  
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700%7cRoboto:400,400italic,700%7cRoboto&#43;Mono">
  
  <link rel="stylesheet" href="/styles.css">
  

  

  
  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="So what ...">
  <link rel="feed" href="/index.xml" type="application/rss+xml" title="So what ...">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/download/">

  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@gilleskratzer">
  <meta property="twitter:creator" content="@gilleskratzer">
  
  <meta property="og:site_name" content="So what ...">
  <meta property="og:url" content="/post/download/">
  <meta property="og:title" content="When do R programmers work? | So what ...">
  <meta property="og:description" content="This post is highly inspired by this post and this post. Here is the necessary code to produce those graphs (be aware that it is time and memory consuming!).
On June 10 2013, RStudio provides CRAN mirror logs download from 2012-10-01. Then it is possible to analyze this rich and huge amount of data. On an individual level, one can track the popularity of their (preferred package). Here one can track the number of download of the three most downloaded R packages.">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2016-09-01T00:00:00&#43;00:00">
  
  <meta property="article:modified_time" content="2016-09-01T00:00:00&#43;00:00">
  

  

  

  <title>When do R programmers work? | So what ...</title>

</head>
<body id="top" data-spy="scroll" data-target="#toc" data-offset="71" >

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
      <a class="navbar-brand" href="/">So what ...</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      
      <ul class="nav navbar-nav navbar-right">
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#publications">
            
            <span>Publications</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#projects">
            
            <span>Projects</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#soft">
            
            <span>Software</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#talks">
            
            <span>Talks</span>
            
          </a>
        </li>

        
        
      

      
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  


  <div class="article-container">
    <h1 itemprop="name">When do R programmers work?</h1>

    

<div class="article-metadata">

  <span class="article-date">
    
    <time datetime="2016-09-01 00:00:00 &#43;0000 UTC" itemprop="datePublished dateModified">
      Sep 1, 2016
    </time>
  </span>
  <span itemscope itemprop="author publisher" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Gilles Kratzer">
  </span>

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    3 min read
  </span>
  

  
  

  
  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="/categories/r/">R</a
    >
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=When%20do%20R%20programmers%20work%3f&amp;url=%2fpost%2fdownload%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=%2fpost%2fdownload%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fpost%2fdownload%2f&amp;title=When%20do%20R%20programmers%20work%3f"
         target="_blank" rel="noopener">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=%2fpost%2fdownload%2f&amp;title=When%20do%20R%20programmers%20work%3f"
         target="_blank" rel="noopener">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=When%20do%20R%20programmers%20work%3f&amp;body=%2fpost%2fdownload%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>


    <div class="article-style" itemprop="articleBody">
      <p><a id="IDdownload"></a></p>
<p>This post is highly inspired by <a href="https://www.r-bloggers.com/finally-tracking-cran-packages-downloads/">this post</a> and <a href="http://blog.kongscn.me/2015/05/15/r-packages-stats.html">this post</a>. <a href="#my_chunk">Here</a> is the necessary code to produce those graphs (be aware that it is time <strong>and</strong> memory consuming!).</p>
<p>On <a href="https://blog.rstudio.org/2013/06/10/rstudio-cran-mirror/">June 10 2013</a>, <a href="https://www.rstudio.com/">RStudio</a> provides CRAN mirror logs download from 2012-10-01. Then it is possible to analyze this <strong>rich and huge</strong> amount of data. On an individual level, one can track the popularity of their (preferred package). Here one can track the number of download of the three most downloaded R packages.</p>
<p>Here is the daily counts for the three most downloaded R packages, for May the 1 to September the 4th 2016. As one can see, there is an obvious weekly seasonality.</p>
<div style="width:800px; height=600px">
<center>
<img src="images/dowloads_top3.png" />
</center>
</div>
<p>Here is the ordered total number of download per country for the same period. Rcpp seems to be the most used R package in all countries except Korea.</p>
<p> </p>
<div style="width:800px; height=600px">
<div class="figure">
<img src="images/country_dowloads_top3.png" />

</div>
</div>
<p> </p>
<p>Here is the total count over the week days for this period. As one can see, number of downloads decreases of about a half during the weekend.</p>
<p> </p>
<div class="figure">
<img src="images/downloads_weekdays_top3.png" />

</div>
<p> </p>
<p>Finally, this graph represents the instantly (smoothed by minute) number of downloads in standardized UTC. As one can see, less downloads during night and lunch time.</p>
<p> </p>
<div class="figure">
<img src="images/downloads_hour_top3.png" />

</div>
<p> </p>
<p>Below is the necessary code to extract, manipulate and plot the data.</p>
<p>  <a id="my_chunk"></a></p>
<pre class="r"><code>###########################################################################
##Gilles Kratzer
##Analysis on CRAN Rstudio log files in order to compute to the number of downloads
##History :
## --2016/09/06 document created
## --2016/09/09 adding material
## --2016/09/21 plotting data
###########################################################################

###########################################################################
##Purpose: Analysis of the downloads of R packages
##Highly inspired by https://www.r-bloggers.com/finally-tracking-cran-packages-downloads/
##Highly inspired by http://blog.kongscn.me/2015/05/15/r-packages-stats.html
###########################################################################

##cleaning
rm(list = ls())
graphics.off()

##packages
library(lubridate)
library(data.table)
library(dplyr)
library(tidyr)
library(dplyr)
library(ggplot2)


## ======================================================================
## Step 1: Download all log files
## ======================================================================


# Here&#39;s an easy way to get all the URLs in R
# It downloads only the missing files
# !!! very long !!!

start &lt;- as.Date(&#39;2016-05-01&#39;)
today &lt;- as.Date(&#39;2016-10-15&#39;)

all_days &lt;- seq(start, today, by = &#39;day&#39;)

year &lt;- as.POSIXlt(all_days)$year + 1900
urls &lt;- paste0(&#39;http://cran-logs.rstudio.com/&#39;, year, &#39;/&#39;, all_days, &#39;.csv.gz&#39;)

# only download missing files
missing_days&lt;-setdiff(as.character(all_days), tools::file_path_sans_ext(dir(&quot;../3m/&quot;), TRUE))

dir.create(&quot;../3m/&quot;)
for (i in 1:length(missing_days)) {
  print(paste0(i, &quot;/&quot;, length(missing_days)))
  download.file(urls[i], paste0(&#39;../3m/&#39;, missing_days[i], &#39;.csv.gz&#39;))
}



## ======================================================================
## Step 2: Make a data table
## ======================================================================

#!!! time and memory consuming

DT = data.table()
files = list.files(&quot;../3m&quot;, pattern=&#39;*.gz&#39;, full.names=TRUE)

for (file in files){
  print(paste(&quot;Reading&quot;, file, &quot;...&quot;))
  dt = tbl_dt(read.csv(file, as.is=TRUE))
  dt = dt[, `:=`(datetime=ymd_hms(paste(date, time)),
                 r_version=as.factor(r_version),
                 r_arch=as.factor(r_arch),
                 r_os=as.factor(r_os),
                 package=as.factor(package),
                 date=NULL, time=NULL, ip_id=NULL, version=NULL)]
  DT = rbind(DT, dt)
}
rm(dt)
DT = tbl_dt(DT)
setkey(DT, package, country)
save(DT, file=&quot;../3m/3m_final.RData&quot;)
gc() # !!!

## ======================================================================
## Step 3: Analysis 
## ======================================================================

load(file = &quot;../3m/3m_final.RData&quot;)

by_package = DT[, .N, keyby=package][order(-N)]

# Top downloads
by_package

top3 = DT[.(c(&quot;Rcpp&quot;,&quot;plyr&quot;, &quot;ggplot2&quot;))]
top3[, `:=`(date=as.Date(datetime))]

top3_stat = top3[, .N, by=.(package, date)]
qplot(x=date, y=N, data=top3_stat, geom=&#39;line&#39;, color=package)

ggsave(filename = &quot;dowloads_top3.pdf&quot;)

by_package &lt;- DT[, .N, keyby=package][order(-N)]

top3[, `:=`(date=as.Date(datetime))]
pack_stat&lt;-top3[, .N, by=.(package, date)]
qplot(x=date, y=N, data=pack_stat, geom=&#39;line&#39;, color=package)

ggsave(filename = &quot;dowloads.pdf&quot;)

##country
pack_stat&lt;-top3[,.N,keyby=.(country, package)][order(-N)]
pack_stat_count_country&lt;-top3[,.N,keyby=.(country)][order(-N)]

pack_stat$country&lt;-factor(x = pack_stat$country,levels = pack_stat_count_country$country)
m = ggplot(pack_stat[1:40], aes(x=country, y=N, fill=package))
m + geom_bar(stat=&quot;identity&quot;) + coord_flip()
ggsave(filename = &quot;country_dowloads_top3.pdf&quot;)

##Download per day
top3$Weekdays &lt;- weekdays(top3$datetime)

pack_stat&lt;-top3[, .N, by=.(package, Weekdays)]
pack_stat$Weekdays&lt;-factor(pack_stat$Weekdays, levels = c(&quot;Monday&quot;, &quot;Tuesday&quot;, &quot;Wednesday&quot;, &quot;Thursday&quot;, 
                                                          &quot;Friday&quot;, &quot;Saturday&quot;,&quot;Sunday&quot;))
ggplot(aes(x=Weekdays, y=N, fill=package), data=pack_stat)+
  geom_bar(stat=&quot;identity&quot;)+
  theme_bw()+
  xlab(NULL)

ggsave(filename = &quot;downloads_weekdays_top3.pdf&quot;)

##downloads per minutes 
top3$specific_time &lt;- hour(top3$datetime)+ minute(top3$datetime)/60
  
pack_stat&lt;-top3[, .N, by=.(package, specific_time)]
qplot(x=specific_time, y=N, data=pack_stat, geom=&#39;line&#39;,color=package)+
  scale_x_continuous(breaks = c(0,3,6, 9, 12, 15,18,21,24), labels=c(
                                          &quot;00:00&quot;,
                                          &quot;03:00&quot;,
                                          &quot;06:00&quot;,
                                          &quot;09:00&quot;,
                                          &quot;12:00&quot;,
                                          &quot;15:00&quot;,
                                          &quot;18:00&quot;,
                                          &quot;21:00&quot;,
                                          &quot;24:00&quot;))+
  xlab(NULL)
  
ggsave(filename = &quot;downloads_hour_top3.pdf&quot;)</code></pre>

    </div>

    


<div class="article-tags">
  
  <a class="btn btn-primary btn-outline" href="/tags/cran/">CRAN</a>
  
  <a class="btn btn-primary btn-outline" href="/tags/data-visualization/">data visualization</a>
  
</div>




    
    

    

    


  </div>
</article>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2018 Gilles Kratzer &middot; 

      Powered by the
      <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
      <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close btn-large" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Cite</h4>
      </div>
      <div>
        <pre><code class="modal-body tex"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-primary btn-outline js-copy-cite" href="#" target="_blank">
          <i class="fa fa-copy"></i> Copy
        </a>
        <a class="btn btn-primary btn-outline js-download-cite" href="#" target="_blank">
          <i class="fa fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    

    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha512-3P8rXCuGJdNZOnUx/03c1jOTnMn3rP63nBip5gOP2qmUh5YAdVAvFZ1E+QLZZbC1rtMrQb+mah3AfYW11RUrWA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>
    
    
    <script src="/js/hugo-academic.js"></script>
    

    
    
      
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
      

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    

  </body>
</html>

